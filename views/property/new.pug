extends ../dashboard-layout 

block content
    .card.bg-light-info.shadow-none.position-relative.overflow-hidden
        .card-body.px-4.py-3
            .row.align-items-center
                .col-9
                    h4.fw-semibold.mb-8 Add New Property
                    nav(aria-label='breadcrumb')
                        ol.breadcrumb
                            li.breadcrumb-item
                                a(href='#') Home
                            li.breadcrumb-item
                                a(href='/property/list') Properties
                            li.breadcrumb-item(aria-current='page') New
                .col-3
                    .text-center.mb-n5

    .row 
        .col-md-12
            .card.w-100.position-relative.overflow-hidden
                .card-body.p-4
                    h4.fw-semibold.mb-4 Property Details 

                    //- New structured form: Sections A–D
                    form(action='/property/new' method='post' enctype='multipart/form-data')
                        // Public visibility note
                        .alert.alert-info Only Size, Price, Location, Asset Class and Pictures & Videos will be publicly visible.

                        // Section A: Basic Property Details
                        h5.mb-3 Basic Property Details
                        .form-group.mb-3
                            label.form-label Property Title/Name
                            input.form-control(name="title" type="text" required placeholder="e.g., 500sqm Plot in Jahi")

                        .form-group.mb-3
                            label.form-label Location / District
                            select.form-control(name="district" required)
                                option(value='') -- Select District --
                                option(value='Guzape') Guzape
                                option(value='Maitama') Maitama
                                option(value='Wuse II') Wuse II
                                option(value='Wuse I') Wuse I
                                option(value='Jahi') Jahi
                                option(value='Gwarinpa') Gwarinpa
                                option(value='Asokoro') Asokoro
                                option(value='Kubwa') Kubwa
                                option(value='Bwari') Bwari

                        .form-group.mb-3.row
                            .col-md-6
                                label.form-label Asset Class
                                select.form-control(name="asset_class" required)
                                    option(value='') -- Select Asset Class --
                                    option(value='Residential') Residential
                                    option(value='Commercial') Commercial
                                    option(value='Mixed-Use') Mixed-Use
                            .col-md-6
                                label.form-label Asking Price (₦)
                                input.form-control(name="price" type='text' required placeholder='e.g., 25,000,000')

                        .form-group.mb-3
                            label.form-label Role
                            select.form-control(name="role" required)
                                option(value='') -- Select Role --
                                option(value='Owner') Owner
                                option(value='Agent') Agent

                        .form-group.mb-3
                            label.form-label Size
                            input.form-control(name="plot_size" type='text' placeholder='e.g., 500 sqm')

                        // Section B: Legal & Technical (Required for Verification)
                        h5.mt-4.mb-3 Legal & Technical (Required for Verification)
                        .form-group.mb-3
                            label.form-label Title Document Type
                            select.form-control(name="title_document_type")
                                option(value='') -- Select Document Type --
                                option(value='C of O') C of O
                                option(value='R of O') R of O
                                option(value='Deed of Assignment') Deed of Assignment
                                option(value='Court Judgment') Court Judgment

                        .form-group.mb-3
                            label.form-label Plot Number
                            input.form-control(name="plot_number" type='text' required placeholder='Critical for AGIS check')

                        .form-group.mb-3
                            label.form-label Name of Allottee/Owner (as on document)
                            input.form-control(name="allottee_name" type='text' required)

                        .form-group.mb-3
                            label.form-label Survey Coordinates / Beacon Numbers
                            input.form-control(name="survey_coordinates" type='text' placeholder='GPS coords or beacon refs')

                        // Section C: Media & Attachments
                        h5.mt-4.mb-3 Media & Attachments
                        .form-group.mb-3
                            label.form-label High-Res Title Document Scan (for OCR)
                            input.form-control(type='file' name='title_document' accept='.pdf,image/*')

                        .form-group.mb-3
                            label.form-label Property Images (Up to 5 high-quality photos)
                            input.form-control(type='file' name='property_images' accept='image/*' multiple)
                            small.form-text.text-muted Upload up to 5 images. Large files recommended as high-res for listings.

                        .form-group.mb-3
                            label.form-label Video Walkthrough (optional)
                            input.form-control(type='file' name='video_walkthrough' accept='video/*')

                        // Section D: Agent/Owner Identity
                        h5.mt-4.mb-3 Agent / Owner Identity
                        .form-group.mb-3
                            label.form-label NIN or RC Number
                            input.form-control(name='nin_rc' type='text' required placeholder='NIN or RC number for verification')

                        .form-group.mb-3.form-check
                            input.form-check-input(type='checkbox' id='listing_consent' name='listing_consent' required)
                            label.form-check-label(for='listing_consent') I confirm that I have the legal right to list this property and that QANDOS will conduct a mandatory audit upon buyer interest.

                        // Visibility control note (informational)
                        p.text-muted.mt-3 Only Size, Price, Location, Asset Class and uploaded Pictures & Videos will be visible to the public. All other details are used for verification and will remain private.

                        .mb-3
                            button.btn.btn-primary.float-end(type='submit') Save Property


        //- .col-md-5 
        //-     .card.w-100.position-relative.overflow-hidden
        //-         .card-body.p-4
        //-             h4.fw-semibold.mb-4 Property Photos 

block scriptBlock
    script. 

        let state;
        document.getElementById('state').addEventListener('change', async function() {
            state = this.value;
            const resp = await fetch('/cities?state=' + state);
            const cities = await resp.json();
            let opts = "<option value=''>-- City --</option>";
            opts += cities.data.cities.map(city => `<option value=${city}>${city}</option>`);
            document.getElementById('city').innerHTML = opts;
        });
